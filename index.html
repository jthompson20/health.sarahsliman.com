<!DOCTYPE html>
<html>
<head>
    <head profile="http://www.w3.org/2005/10/profile">
    <link rel="icon" type="image/png" href="/images/muscle-32.png">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Sarah Sliman's Power Group">
    <meta name="theme-color" content="#999999">
	<title>Power Group</title>
	<link rel="manifest" href="/manifest.json">
    <!-- Insert link to stylesheet here -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
	<link rel='stylesheet' href='/styles/style.css'/>

    <!-- Firebase Login -->
    <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyDB2ge6P56SeA4epHvs9cnVTN-nSu9kiF0",
        authDomain: "sarahs-power-group.firebaseapp.com",
        databaseURL: "https://sarahs-power-group.firebaseio.com",
        projectId: "sarahs-power-group",
        storageBucket: "",
        messagingSenderId: "1073212284655"
      };
      firebase.initializeApp(config);
    </script>
    <script type="text/javascript">
      initApp = function() {
        firebase.auth().onAuthStateChanged(function(user) {
          if (user) {

            console.log('>> user',user);

            // User is signed in.
            var displayName = user.displayName;
            var email = user.email;
            var emailVerified = user.emailVerified;
            var photoURL = user.photoURL;
            var uid = user.uid;
            var phoneNumber = user.phoneNumber;
            var providerData = user.providerData;

            // make request to see if they are an active user
            var request = new XMLHttpRequest();
              request.onreadystatechange = function() {
                if (request.readyState === XMLHttpRequest.DONE) {
                  if (request.status === 200) {
                    var response = JSON.parse(request.response);
                    var auth    = false;
                    for (var i = 0; i < response.length; i++){
                      if (email == response[i].email){
                        auth    = true;
                        break;
                      }
                    }
                    //determine if allowed access or not
                    if ( ! auth){
                        window.location     = '/offer.html';
                    }
                  }
                }
              };
              request.open('GET', '/admin/auth.json');
              request.send();

            /*
            user.getIdToken().then(function(accessToken) {
              document.getElementById('sign-in-status').textContent = 'Signed in';
              document.getElementById('sign-in').textContent = 'Sign out';
              document.getElementById('account-details').textContent = JSON.stringify({
                displayName: displayName,
                email: email,
                emailVerified: emailVerified,
                phoneNumber: phoneNumber,
                photoURL: photoURL,
                uid: uid,
                accessToken: accessToken,
                providerData: providerData
              }, null, '  ');
            });
            */
          } else {
            // User is signed out.
            window.location     = '/login.html';
          }
        }, function(error) {
          console.log(error);
        });
      };

      window.addEventListener('load', function() {
        initApp()
      });
    </script>

</head>
<body>

<header class="header">
    <h1 class="header__title">Power Group</h1>
    <img id="refresh" aria-label="Refresh" class="refresh" src="/images/refresh-128.png" height="40" />
    <img id="butFacebook" aria-label="Facebook" class="facebook" src="/images/fb-128.png" height="30" />
    <img id="butHome" aria-label="My Account" class="myaccount" src="/images/myaccount.png" height="30" />
    
</header>

<div class="container">
    <div class="column add-bottom">
        <div id="mainwrap">

            <div class="messagebox">
                <p class="message"></p>
            </div>

            <div class="center column">
                <hr />
            </div>

            <div id="audiowrap">
                
                <div id="audio0">
                    <audio id="audio-player" class="hidden" controls="controls">Your browser does not support HTML5 Audio!</audio>
                </div>

                <!--
                <div id="tracks">
                    <a id="btnPrev">&larr;</a>
                    <a id="btnNext">&rarr;</a>
                </div>
            	-->

            </div>
            <div id="plwrap">
                <ul id="plList">
                    <li class="cardTemplate hidden">
                        <div class="plItem">
                            <div class="plNum">
                                <img src="/images/play.png" height="30"/>
                            </div>
                            <div class="plTitle">Welcome Message</div>
                            <div class="plLength">
                                
                            </div>
                        </div>
                    </li>
                </ul>
            </div>

            <div class="center column">
                <hr />
            </div>

            <div class="center column add-bottom">
                <p class="lastupdated"><small>Last Updated: <span class="time"></span></small></p>
            </div>

        </div>
    </div>
    <div class="column add-bottom center">
        <p>&copy; Sarah Sliman</p>
    </div>
</div>

<div class="loader">
    <svg viewBox="0 0 32 32" width="32" height="32">
        <circle id="ud811Spinner" cx="16" cy="16" r="14" fill="none"></circle>
    </svg>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
<script src="/scripts/localforage-1.4.0.js"></script>
<script src="/scripts/app.js"></script>

</body>
</html>